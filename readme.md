# Требования к программе FileManager.ps1

## Описание

Графическое приложение для Windows на PowerShell, предназначенное для удобного просмотра, поиска, сортировки и удаления файлов в выбранной папке.

---

## Требования к функционалу

- **Загрузка файлов:**

  - По умолчанию открывает папку `G:\My Drive\recordings` (если существует).
  - Позволяет выбрать другую папку через кнопку "Select Folder".

- **Таблица файлов:**

  - Отображает список файлов выбранной папки.
  - В таблице две колонки:
    - `File Name` — имя файла
    - `Size (MB)` — размер файла в мегабайтах
  - Таблица поддерживает прокрутку, масштабируется при изменении размера окна.

- **Удаление файлов:**

  - Можно выделять один или несколько файлов (Ctrl/Shift).
  - Кнопка "Delete Selected" удаляет выбранные файлы в корзину (Recycle Bin).

- **Открытие файлов:**

  - Двойной клик по файлу открывает его в приложении по умолчанию.

- **Сортировка:**

  - Кнопка "Sort by Name" сортирует список по имени файла (A-Z).
  - Кнопка "Sort by Size" сортирует по размеру файла (по убыванию).
  - Сортировка применяется только к отображаемым (отфильтрованным) файлам.

- **Поиск/фильтрация:**

  - Вторая строка интерфейса содержит:
    - Подпись "Filter:"
    - Поле ввода для шаблона/регулярного выражения
    - Кнопку "Search" для применения фильтра
  - Список фильтруется по введённому шаблону (ищет в имени файла).
  - Поддерживаются регулярные выражения (нечувствительно к регистру).
    - Пример: `^[^а-яА-ЯёЁіІїЇєЄґҐa-zA-Z]+$` — найдет файлы, не содержащие букв (только цифры, символы).
    - Пример: `[а-яА-ЯёЁіІїЇєЄґҐa-zA-Z]` — найдет файлы, содержащие хотя бы одну букву (кириллицу или латиницу).
  - Если выражение некорректно — поиск выполняется как по подстроке (также нечувствительно к регистру).
  - Поиск запускается только по кнопке или клавише Enter в поле.

- **Статистика:**

  - Отображается общее количество файлов в списке и их суммарный размер (в мегабайтах).
  - Лейблы динамически обновляются и не переносят текст на новую строку.

- **UI:**
  - Все элементы (кнопки, таблица, лейблы) подстраиваются под размер окна.
  - Нет лишнего вывода в консоль.

---

## Ограничения

- Работает только на Windows с установленным PowerShell (рекомендуется PowerShell 5.1).
- Не требует сторонних библиотек и не вносит изменений в систему.
- Для запуска без консоли рекомендуется использовать ярлык с параметром `-WindowStyle Hidden` или .vbs-обёртку.

---

## Файлы

- Основной скрипт: `FileManager.ps1`
- (Опционально) Сопроводительный файл требований: `FileManager_requirements.md`
- (Опционально) .vbs-обёртка для тихого запуска: `RunFileManager.vbs`

---
